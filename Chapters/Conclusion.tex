\pagestyle{fancy}

Beam diagnostics and instrumentation are essential constituents of any particle accelerator. Without adequate diagnostics, one would be blindly operating an accelerator and it would be impossible to assess problems and improve performance. In this work, we have mainly talked about thin target detectors like SEM grids, Wire Scanners and Foils. As was explained in Chapter \ref{ch:BeamMatterInter}, during measurements, the beam of particles deposits some energy in the detectors. Depending on the beam conditions, the thermal shock suffered by the detectors can be very severe. This might affect the measured currents (Thermionic Emission), or in some cases permanently damage the detectors. As could be seen from the examples in Chapter \ref{ch:TempModeling} with examples of the SPS and the LINAC4. 

The main objective of this thesis was to implement a simulation tool to model the thermal evolution of thin target detectors. For a variety of beam conditions and detector materials. The research conducted by M. Sapinski in 2012 \parencite[]{ref:Msapinski} served as a starting point for this work. He implemented a code to simulate the thermal evolution of fast wire scanners in the context of the SPS accelerator. For this thesis, we sought to extend that concept to also be able to simulate SEM grid detectors, and slow wire scanners and to include a 2D case to simulate thin foil detectors.  

This required diving deeper into the formal aspects of the problem and understanding how this problem could be numerically solved in an efficient and easy-to-implement manner. To solve the non-linear PDE that expresses our heat equation, the theory of finite differences has been used. Three different schemes (FTCS, BTCS, Crank-Nicolson) have been implemented and can be used at the user's convenience. As detailedly explained in Section \ref{sec:GUI}, it can currently simulate a variety of conditions. These include different types of particle beams, with different energies, intensities, pulse lengths, and particle types. It accepts different types of detectors with various materials and geometries. This has been implemented in a modular way to make it very simple to add new simulation conditions to the already existing ones.


The code needed to be accessible to a wide range of users without requiring them to be familiar with the programming or modeling complexities that lay beneath it. For that reason, a lot of effort was put into creating an intuitive and easy-to-use user-friendly interface.  We have named the code PyTT. It is currently fully functional and ready to use. It is publically available at \parencite[]{ref:GitAra}.  A summary of the models behind this code was already presented and published in IBIC 2020 \parencite[][]{ref:IBIC2019ARaceli}. A more detailed Journal outlining the project's current state is currently being written. 

The thermal model relies on a big variety of parameters. A thorough investigation was conducted to determine how much the different parameters affected the simulation results (Section \ref{sec:ModelUnc}). On the one hand, we saw how uncertainties in the beam size significantly impacted the simulation results, especially for small beam sizes ( $< 1$ mm ). On the other hand, we saw how uncertainties in material properties highly affected the results. These properties can be found in the literature, and the uncertainty of such values is material-dependent. For Tungsten, we found that the emissivity property was the source of the highest uncertainty, reaching a 43.26$\%$ uncertainty. For Graphite, a much higher uncertainty of 22.71$\%$ was found in its thermal conductivity. 

Once the PyTT code was implemented, we wanted to crosscheck that the results were a correct description of reality (Chapter \ref{ch:ThermoMeasur}). First, we made a comparison between the results obtained with the PyTT code and those obtained with Ansys, a highly used and benchmarked commercially available software. A LINAC4-like beam of particles was considered as the heating source and studies were performed for thin Tungsten wires and Graphite foils. From this study, we observed that the PyTT code was giving systematically higher maximum temperature results, showing a maximum discrepancy of 11.2$\%$ for a temperature of 1356 K. Ansys also presented a much faster cooling at higher temperatures and a slower cooling at lower temperatures. One big difference between both codes was the simulation time. PyTT averaged much shorter simulation times than Ansys. It was very difficult to properly understand the discrepancies between these two codes as the numerical methods employed by Ansys are not publicly available.

We also wanted to compare the thermal simulations with experimental measurements (Section \ref{sec:ThAtLINAC4}). However, no dedicated setup could be installed in any of the CERN machines. The information available was the intensity registered by the SEM Grids and wire scanners along the LINAC4 accelerator. So we went ahead and used thermionic emission to indirectly measure the thermal evolution. Due to the close relationship between the thermionic current and the temperature, by comparing the simulated current and the experimentally measured one, we could judge the reliability of our thermal simulation results. 

For the experimental planning, we selected the beam conditions that would yield a measurable thermionic current. We were restricted in our choice of detector and timing due to the potentially destructive nature of this experiment. During the experiment, the beam intensity was kept constant to 17.30(17) mA while the beam pulse length was systematically increased from 50 $\mu s$ up to 450 $\mu s$. Two different beam size conditions were measured. Firstly, a larger beam ( $\sigma_x $ = 1.02(5) mm and $\sigma_y$ = 1.76(2) mm) centered on the grid was measured. Although thermionic emission was not seen in this case, the moment when two wires were glued together could be measured quite clearly. 

Secondly, a smaller beam of particles ( $\sigma_x = 0.59(17)$ mm $\sigma_y = 3.23(54)$ mm ) was measured. In this case, thermionic emission was observable in various wires for a pulse length of $\sim$450 $\mu s$. This measurement was reproduced as close as possible with the PyTT code. The maximum relative error between simulated and measured results is found to be around 30 $\%$, and it is found at the very end of the beam shot. Even then, the average relative error along the whole pulse is 6.3(25)$\%$. A systematic study of the simulation uncertainties was performed for this experiment. Big uncertainties were found, mainly in the thermionic current regime. The biggest contributor to the simulationâ€™s uncertainty came from uncertainties in the beam size ($\xi_x$ = 28.81$\%$).  

PyTT has been already used for a variety of applications, both at CERN and in other facilities. These applications include beam power limit calculations for SEM grids and Wire Scanners at CERN LINAC4, fast wire scanners and thin foils (BTVs) at CERN SPS and Hi-RadMat. It has also been used in other facilities such as DESY (Germany), ISIS (UK) and GSI (Germany) for SEM grid simulations. In this work, we only presented the beam power limits calculations at LINAC4, SPS (Chapter \ref{ch:ThermoMeasur}) and GSI (Chapter \ref{ch:GSIMEasurements}) as they were the most extensive and time-consuming studies performed. 

In CERN, in particular, at LINAC4, SEM grid detectors are made of gold-coated tungsten wires. To obtain accurate results on the thermal limit calculations it was important to reduce the simulation uncertainties brought by the uncertainties in the Emissivity of Tungsten (Chapter \ref{ch:EmissivityMeas}). An experimental setup was designed and implemented to measure the total directional emissivity of thin wires. This was done using the calorimetric method. The two biggest challenges of this experiment were: Firstly, the implementation of a set of electronics to both control the wire heating and acquire the measured data. And secondly, the implementation of the data analysis tools and the numerical methods to extract the value of the emissivity from the measured data. 

The emissivity of 40 $\mu m$ Tungsten wires (both with gold-coating and without) was measured. The emissivity of the pure tungsten wires was, on average, larger than the emissivity of the gold-coated tungsten wires, ranging from 0.087(12) up to 0.176(21). The emissivity values for the gold-coated tungsten wires appear to be consistent with the reported values of the emissivity of gold. In the case of pure tungsten wires, the measured values agree with some published references. Particularly those reporting values of poor electromagnetic radiators. The average statistical relative error for the measured values was 15.21$\%$ in the case of pure tungsten wires and 26.26$\%$ for gold-coated tungsten wires. All these results were summarized and published in \parencite[][]{ref:IBIC2022Araceli}.  

The main focus of this work has been on the thermal simulations and all their implications. However, there have also been other, more practical things done that are directly relevant to CERN operation. A thorough understanding of the signal production in SEM grids and Write scanners was crucial to assist in a range of tests carried out with these detectors, mainly in the LINAC4 context. An example of these measurements is the profile and current measurements for the LBE run presented in Section \ref{sec:LBE}. 

Another example of how this work was useful for CERN operation is presented in Chapter \ref{ch:H0Hm} with the calibration of the \hzhm monitors. To inject the \hm beam of particles to the PSB a new CEI system was installed at CERN. An intensity measurement of both, the unstripped \hzz and \hm beam particles is required to allow an efficient injection setup, monitor the efficiency of the stripping foil and protect the dump in case of a high-intensity beam impact (by providing an interlock signal in case of stripping foil failure). The \hzhm were installed and fully calibrated during the realization of this thesis. 

This calibration implied understanding thoroughly the electronics, the acquisition system and the different signals available from these monitors. This calibration was performed by comparing the current measured the \hzhm with the current measured by an independent BCT. This calibration had to be performed for all the current monitor plates, for all the rings and a variety of beam conditions.  This process was challenging, time-consuming and it was done in collaboration with the ABT group. The calibration process yielded an absolute calibration factor of 1.560(33)$\cdot 10^8$ Charges/ADC count. This value was slightly dependent on the beam pulse length and number of turns, but this discrepancy was associated with mismatches in the BCT and \hzhm measurements. Since this calibration took place, these monitors have been extensively used. They can measure stripping inefficiencies of $\sim 0.1 \%$. The calibration process and results were summarised and published in \parencite[][]{ref:Ibic2021Araceli}.

In June 2022 a dedicated set of measurements were performed in GSI (Darmstadt, Germany) for the commissioning of two SEM grid prototypes, designed by PROACTIVE. All the knowledge gained during this thesis served to assist with the measurements. For this experiment, an $Ar^{10+}$ beam of particles was used. With a beam energy of 8.6 MeV/u and a repetition rate of 1 Hz. We could confirm the improvement in the beam profile resolution measurable with the PROACTIVE grids and the correct functioning of the vias voltage. In parallel to the measurements, simulations for wire heating were done with the PyTT code, predicting the wire temperature at the various measurements. However, in this case, the thermal simulations were inconclusive due to the big uncertainties in the beam energy deposition. Part of these studies were published and presented in \parencite[][]{ref:Linac2022Thomas} and \parencite[][]{ref:Ibic2022Juan}. The studies on the thermal properties are still undergoing.

The types of detectors and operational principles covered in this work are nothing new. They have been extensively used in particle accelerators for decades but even nowadays, they are being used and installed in the most recent and cutting-edge machines in the world of accelerator physics. This research moves us one step closer to fully understanding these detectors, allowing us to fully exploit their potential. All the goals and objectives proposed for this thesis have been achieved. Additional research to the original planning was conducted to address the issues and difficulties that arose along the way.  

Unfortunately, time is limited, and even if the objectives were covered, there are always some points that merit further investigation. For example, it would be interesting to compare the PyTT code results to a wider range of cases. Different beam conditions, energy ranges, different detector materials and machines. It would be of particular interest to crosscheck the PyTT simulations with Heavier Ions machines.

The emissivity measurement performed during this work, despite having a relatively straightforward setup, is very powerful and could be easily exploited further. Many more wire types could be measured. Wires of different materials, such as graphite wires (for measuring conductivity properties) or the currently popular carbon nanotube wires.  As far as the \hzhm monitors are concerned, they are currently fully operational and they are being used extensively. However, they are currently facing electronic interference problems. A lot of work is currently being done to solve this issue.  

This work has brought us one step ahead in the good direction, and it will hopefully assist all the others who will follow in further exploring this long-standing but extremely challenging topic.